{"version":3,"file":"index-nSck01LY.mjs","sources":["../src/compute/rt/index.ts"],"sourcesContent":["import Solver, { SolverParams } from \"../solver\";\r\nimport Room from \"../../objects/room\";\r\nimport Surface from \"../../objects/surface\";\r\nimport { third_octave, whole_octave } from '../acoustics';\r\nimport { RT_CONSTANTS } from '../../constants/rt-constants';\r\nimport { emit, on } from \"../../messenger\";\r\nimport { Matrix4, Triangle, Vector3 } from \"three\";\r\nimport { addSolver, removeSolver, Result, ResultKind, ResultTypes, setSolverProperty, useAppStore, useContainer, useResult, useSolver } from \"../../store\";\r\nimport { v4 as uuid } from 'uuid';\r\nimport FileSaver from 'file-saver'; \r\nimport roundTo from \"../../common/round-to\";\r\n\r\nexport interface RT60Props extends SolverParams{\r\n  //uuid?: string;\r\n  // containers: KVP<Container>; \r\n}\r\n\r\nexport type RT60SaveObject = {\r\n  uuid: string;\r\n  name: string;\r\n  kind: \"rt60\";\r\n  autoCalculate: boolean;\r\n}\r\n\r\nconst defaults = {\r\n  name: \"RT\",\r\n};\r\n\r\nexport class RT60 extends Solver{\r\n  public uuid; \r\n  public sabine_rt: number[]; \r\n  public eyring_rt: number[];\r\n  public ap_rt: number[]; \r\n\r\n  public volume: number; \r\n\r\n  public frequencies: number[];\r\n\r\n  public roomID: string;\r\n\r\n  public resultID: string;\r\n\r\n  public resultExists: boolean; \r\n\r\n  constructor(props: RT60Props = defaults) {\r\n    super(props);\r\n    this.kind = \"rt60\";\r\n    this.name = props.name || defaults.name;\r\n    this.uuid = uuid(); \r\n\r\n    this.sabine_rt = [];\r\n    this.eyring_rt = []; \r\n    this.ap_rt = [];\r\n \r\n    const rooms = useContainer.getState().getRooms();\r\n    this.roomID = rooms.length > 0 ? rooms[0].uuid : ''; \r\n\r\n    this.frequencies = whole_octave.slice(4,11);   \r\n\r\n    this.resultID = uuid(); \r\n    this.resultExists = false; \r\n\r\n    this.volume = (useContainer.getState().containers[this.roomID] as Room).volumeOfMesh();\r\n  }\r\n\r\n  save() {\r\n     const { name, kind, uuid, autoCalculate } = this;\r\n     return {\r\n       name,\r\n       kind,\r\n       uuid,\r\n       autoCalculate,\r\n     } as RT60SaveObject;\r\n  }\r\n\r\n  restore(state: RT60SaveObject) {\r\n    // Let the base Solver restore shared properties like autoCalculate\r\n    super.restore(state);\r\n    // Restore RT60-specific/core identity properties\r\n    this.kind = state.kind;\r\n    return this;\r\n  }\r\n\r\n  calculate(){\r\n\r\n    this.reset(); \r\n\r\n    this.sabine_rt = this.sabine();\r\n    this.eyring_rt = this.eyring(); \r\n    this.ap_rt = this.arauPuchades(this.room,this.frequencies); \r\n\r\n    if(!this.resultExists){\r\n      emit(\"ADD_RESULT\", {\r\n        kind: ResultKind.StatisticalRT60,\r\n        data: [],\r\n        info: {\r\n          frequency: this.frequencies,\r\n          airabsorption: false,\r\n          temperature: 20,\r\n          humidity: 40,\r\n        },\r\n        name: `Statistical RT Results`,\r\n        uuid: this.resultID,\r\n        from: this.uuid\r\n      } as Result<ResultKind.StatisticalRT60>);\r\n      this.resultExists = true;\r\n    }\r\n\r\n    const rt60results = { ...useResult.getState().results[this.resultID] as Result<ResultKind.StatisticalRT60> };\r\n    rt60results.data = [] as ResultTypes[ResultKind.StatisticalRT60][\"data\"];\r\n\r\n    for(let i = 0; i<this.frequencies.length; i++){\r\n      rt60results.data.push({\r\n        frequency: this.frequencies[i], \r\n        sabine: this.sabine_rt[i],\r\n        eyring: this.eyring_rt[i],\r\n        ap: this.ap_rt[i]\r\n      })\r\n    }\r\n    emit(\"UPDATE_RESULT\", { uuid: this.resultID, result: rt60results });\r\n  }\r\n\r\n  reset(){\r\n    this.sabine_rt = [];\r\n    this.eyring_rt = []; \r\n    this.ap_rt = []; \r\n  }\r\n\r\n  sabine() {\r\n    let room = this.room; \r\n    const unitsConstant = this.unitsConstant;\r\n    const v = this.volume;\r\n\r\n    const response = [] as number[];\r\n    this.frequencies.forEach((frequency) => {\r\n      let sum = 0;\r\n      room.allSurfaces.forEach((surface: Surface) => {\r\n        sum += surface.getArea() * surface.absorptionFunction(frequency);\r\n      });\r\n      let airabsterm = 4*airAbs20c40rh(frequency)*v; \r\n      response.push((unitsConstant*v)/(sum+airabsterm)); \r\n    });\r\n    return response;\r\n  }\r\n  \r\n  eyring(){\r\n    let room = this.room; \r\n    const unitsConstant = this.unitsConstant;\r\n    const v = this.volume;\r\n     \r\n    const response = [] as number[]; \r\n    this.frequencies.forEach((frequency) => {\r\n      let sum = 0; \r\n      let totalSurfaceArea = 0; \r\n      room.allSurfaces.forEach((surface: Surface) => {\r\n        totalSurfaceArea += surface.getArea(); \r\n        sum += surface.getArea() * surface.absorptionFunction(frequency);\r\n      });\r\n      let avg_abs = sum / totalSurfaceArea; \r\n      let airabsterm = 4*airAbs20c40rh(frequency)*v; \r\n      response.push((unitsConstant * v) / (-totalSurfaceArea*Math.log(1-avg_abs)+airabsterm));\r\n    });\r\n    return response; \r\n  }\r\n\r\n\r\n  arauPuchades(room: Room, frequencies: number[] = third_octave) {\r\n    \r\n    // the goal of arau puchades is to break the surfaces into components (x, y, z)\r\n    // well do this by projecting each surface onto the planes x=0, y=0, and z=0\r\n    // https://en.wikipedia.org/wiki/Orthographic_projection\r\n    \r\n\r\n    const v = room.volumeOfMesh();\r\n    const unitsConstant = this.unitsConstant;\r\n    // prettier-ignore\r\n    const Px = new Matrix4().fromArray([\r\n      [0, 0, 0, 0],\r\n      [0, 1, 0, 0],\r\n      [0, 0, 1, 0],\r\n      [0, 0, 0, 1]\r\n    ].flat());\r\n\r\n    // prettier-ignore\r\n    const Py = new Matrix4().fromArray([\r\n      [1, 0, 0, 0],\r\n      [0, 0, 0, 0],\r\n      [0, 0, 1, 0],\r\n      [0, 0, 0, 1]\r\n    ].flat());\r\n\r\n    // prettier-ignore\r\n    const Pz = new Matrix4().fromArray([\r\n      [1, 0, 0, 0],\r\n      [0, 1, 0, 0],\r\n      [0, 0, 0, 0],\r\n      [0, 0, 0, 1]\r\n    ].flat());\r\n\r\n    // [Px, Py, Pz].map\r\n    const planes = [Px, Py, Pz];\r\n\r\n    const surfaces = room.allSurfaces as Surface[];\r\n    const projectedSurfaces = surfaces.map(surface => {\r\n      const area = surface.triangles.reduce((acc,tri) => {\r\n        const projectedVectors = planes.map(P=>tri.map(pt => new Vector3().fromArray(pt).applyMatrix4(P)));\r\n        // the projected areas [x,y,z] for this triangle\r\n        const areas = projectedVectors.map(vectors=>new Triangle(...vectors).getArea());\r\n        return acc.map((a,i)=>a+areas[i]);\r\n      }, [0,0,0]);\r\n\r\n      const sabines = frequencies.map(freq=>area.map(a=>surface.absorptionFunction(freq)*a));\r\n      return { area, sabines };\r\n    });\r\n\r\n    const [[Ax, αx],[Ay, αy],[Az, αz]] = [0,1,2].map(i=>{\r\n      const surfacearea = projectedSurfaces.reduce((acc, { area })=>acc + area[i], 0);\r\n      const sabines = frequencies.map((freq,f) => projectedSurfaces.reduce((acc, { sabines })=> acc+sabines[f][i], 0));\r\n      const alphas = sabines.map(sabine=>sabine/surfacearea);\r\n      return [surfacearea, alphas];\r\n    });\r\n\r\n    const A = Ax+Ay+Az;\r\n\r\n    return frequencies.map((freq,f)=>{\r\n      const rt = \r\n      ((unitsConstant*v) / (-A * (Math.log(1-αx[f]))) ) ** (Ax/A) *\r\n      ((unitsConstant*v) / (-A * (Math.log(1-αy[f]))) ) ** (Ay/A) *\r\n      ((unitsConstant*v) / (-A * (Math.log(1-αz[f]))) ) ** (Az/A);\r\n      return rt;\r\n    });\r\n  }\r\n\r\n  onParameterConfigFocus() {}\r\n  onParameterConfigBlur() {}\r\n\r\n  downloadRT60AsCSV(){\r\n\r\n    let precision = 4;\r\n    let freqlabel = \"Octave Band (Hz),\"\r\n    let sabinelabel = \"Sabine RT,\";\r\n    let eyringlabel = \"Eyring RT,\";\r\n    let aplabel = \"Arau-Puchades RT,\";\r\n\r\n    let CSV = [freqlabel.concat((this.frequencies).toString()),\r\n      sabinelabel.concat((this.sabine_rt).map((n)=>n.toFixed(precision)).toString()),\r\n      eyringlabel.concat((this.eyring_rt).map((n)=>n.toFixed(precision)).toString()),\r\n      aplabel.concat((this.ap_rt).map((n)=>n.toFixed(precision)).toString()),\r\n    ].join('\\n');\r\n\r\n    console.log(CSV); \r\n\r\n    var csvFile = new Blob([CSV], {type: 'text/csv'});\r\n    FileSaver.saveAs(csvFile, `rt60-${this.uuid}.csv`);\r\n  }\r\n\r\n\r\n  // setters and getters\r\n  get unitsConstant(){\r\n    return RT_CONSTANTS[useAppStore.getState().units];\r\n  }\r\n  get room(){\r\n    return useContainer.getState().containers[this.roomID] as Room; \r\n  }\r\n  get noResults(){\r\n    if (this.sabine_rt.length === 0 && this.eyring_rt.length === 0  && this.ap_rt.length === 0 ){\r\n      return true;\r\n    }else{\r\n      return false;\r\n    }\r\n  }\r\n  get displayVolume(){\r\n    return roundTo(this.volume, 2);\r\n  }\r\n\r\n  set displayVolume(volume: number){\r\n    this.volume = volume;\r\n  }\r\n}\r\n\r\nfunction airAbs20c40rh(f: number): number {\r\n  // returns metric value of the air abosprtion coefficient m at 20c 40 rh\r\n  // hardcoded for capstone demonstration\r\n\r\n  switch(f){\r\n    case 125:\r\n      return 0;\r\n    case 250:\r\n      return 0;\r\n    case 500:\r\n      return 0.000600423;\r\n    case 1000:\r\n      return 0.001069606;\r\n    case 2000:\r\n      return 0.002578866;\r\n    case 4000:\r\n      return 0.00839936;\r\n    case 8000:\r\n      return 0.0246;\r\n    default:\r\n      return 0;\r\n  }\r\n}\r\n\r\nexport default RT60;\r\n\r\n\r\n\r\n// this allows for nice type checking with 'on' and 'emit' from messenger\r\ndeclare global {\r\n  interface EventTypes {\r\n    ADD_RT60: RT60 | undefined,\r\n    REMOVE_RT60: string,\r\n    RT60_SET_PROPERTY: {\r\n      uuid: string;\r\n      property: keyof RT60;\r\n      value: RT60[EventTypes[\"RT60_SET_PROPERTY\"][\"property\"]]; \r\n    }\r\n    UPDATE_RT60: string; \r\n    DOWNLOAD_RT60_RESULTS: string; \r\n  }\r\n}\r\n\r\n// add event listener \r\non(\"ADD_RT60\", addSolver(RT60)); \r\non(\"UPDATE_RT60\", (uuid: string) => void (useSolver.getState().solvers[uuid] as RT60).calculate());\r\non(\"REMOVE_RT60\", removeSolver); \r\non(\"DOWNLOAD_RT60_RESULTS\", (uuid: string) => void (useSolver.getState().solvers[uuid] as RT60).downloadRT60AsCSV()); \r\non(\"RT60_SET_PROPERTY\", setSolverProperty); \r\n\r\n"],"names":["defaults","RT60","Solver","props","uuid","rooms","useContainer","whole_octave","name","kind","autoCalculate","state","emit","ResultKind","rt60results","useResult","i","room","unitsConstant","v","response","frequency","sum","surface","airabsterm","airAbs20c40rh","totalSurfaceArea","avg_abs","frequencies","third_octave","Px","Matrix4","Py","Pz","planes","projectedSurfaces","area","acc","tri","areas","P","pt","Vector3","vectors","Triangle","a","sabines","freq","Ax","αx","Ay","αy","Az","αz","surfacearea","alphas","f","sabine","A","precision","CSV","n","csvFile","FileSaver","RT_CONSTANTS","useAppStore","roundTo","volume","on","addSolver","useSolver","removeSolver","setSolverProperty"],"mappings":";;;AAwBA,MAAMA,IAAW;AAAA,EACf,MAAM;AACR;AAEO,MAAMC,UAAaC,EAAM;AAAA,EACvB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEP,YAAYC,IAAmBH,GAAU;AACvC,UAAMG,CAAK,GACX,KAAK,OAAO,QACZ,KAAK,OAAOA,EAAM,QAAQH,EAAS,MACnC,KAAK,OAAOI,EAAA,GAEZ,KAAK,YAAY,CAAA,GACjB,KAAK,YAAY,CAAA,GACjB,KAAK,QAAQ,CAAA;AAEb,UAAMC,IAAQC,EAAa,SAAA,EAAW,SAAA;AACtC,SAAK,SAASD,EAAM,SAAS,IAAIA,EAAM,CAAC,EAAE,OAAO,IAEjD,KAAK,cAAcE,EAAa,MAAM,GAAE,EAAE,GAE1C,KAAK,WAAWH,EAAA,GAChB,KAAK,eAAe,IAEpB,KAAK,SAAUE,EAAa,SAAA,EAAW,WAAW,KAAK,MAAM,EAAW,aAAA;AAAA,EAC1E;AAAA,EAEA,OAAO;AACJ,UAAM,EAAE,MAAAE,GAAM,MAAAC,GAAM,MAAAL,GAAM,eAAAM,MAAkB;AAC5C,WAAO;AAAA,MACL,MAAAF;AAAA,MACA,MAAAC;AAAA,MACA,MAAAL;AAAAA,MACA,eAAAM;AAAA,IAAA;AAAA,EAEL;AAAA,EAEA,QAAQC,GAAuB;AAE7B,iBAAM,QAAQA,CAAK,GAEnB,KAAK,OAAOA,EAAM,MACX;AAAA,EACT;AAAA,EAEA,YAAW;AAET,SAAK,MAAA,GAEL,KAAK,YAAY,KAAK,OAAA,GACtB,KAAK,YAAY,KAAK,OAAA,GACtB,KAAK,QAAQ,KAAK,aAAa,KAAK,MAAK,KAAK,WAAW,GAErD,KAAK,iBACPC,EAAK,cAAc;AAAA,MACjB,MAAMC,EAAW;AAAA,MACjB,MAAM,CAAA;AAAA,MACN,MAAM;AAAA,QACJ,WAAW,KAAK;AAAA,QAChB,eAAe;AAAA,QACf,aAAa;AAAA,QACb,UAAU;AAAA,MAAA;AAAA,MAEZ,MAAM;AAAA,MACN,MAAM,KAAK;AAAA,MACX,MAAM,KAAK;AAAA,IAAA,CAC0B,GACvC,KAAK,eAAe;AAGtB,UAAMC,IAAc,EAAE,GAAGC,EAAU,WAAW,QAAQ,KAAK,QAAQ,EAAA;AACnE,IAAAD,EAAY,OAAO,CAAA;AAEnB,aAAQE,IAAI,GAAGA,IAAE,KAAK,YAAY,QAAQA;AACxC,MAAAF,EAAY,KAAK,KAAK;AAAA,QACpB,WAAW,KAAK,YAAYE,CAAC;AAAA,QAC7B,QAAQ,KAAK,UAAUA,CAAC;AAAA,QACxB,QAAQ,KAAK,UAAUA,CAAC;AAAA,QACxB,IAAI,KAAK,MAAMA,CAAC;AAAA,MAAA,CACjB;AAEH,IAAAJ,EAAK,iBAAiB,EAAE,MAAM,KAAK,UAAU,QAAQE,GAAa;AAAA,EACpE;AAAA,EAEA,QAAO;AACL,SAAK,YAAY,CAAA,GACjB,KAAK,YAAY,CAAA,GACjB,KAAK,QAAQ,CAAA;AAAA,EACf;AAAA,EAEA,SAAS;AACP,QAAIG,IAAO,KAAK;AAChB,UAAMC,IAAgB,KAAK,eACrBC,IAAI,KAAK,QAETC,IAAW,CAAA;AACjB,gBAAK,YAAY,QAAQ,CAACC,MAAc;AACtC,UAAIC,IAAM;AACV,MAAAL,EAAK,YAAY,QAAQ,CAACM,MAAqB;AAC7C,QAAAD,KAAOC,EAAQ,QAAA,IAAYA,EAAQ,mBAAmBF,CAAS;AAAA,MACjE,CAAC;AACD,UAAIG,IAAa,IAAEC,EAAcJ,CAAS,IAAEF;AAC5C,MAAAC,EAAS,KAAMF,IAAcC,KAAIG,IAAIE,EAAW;AAAA,IAClD,CAAC,GACMJ;AAAA,EACT;AAAA,EAEA,SAAQ;AACN,QAAIH,IAAO,KAAK;AAChB,UAAMC,IAAgB,KAAK,eACrBC,IAAI,KAAK,QAETC,IAAW,CAAA;AACjB,gBAAK,YAAY,QAAQ,CAACC,MAAc;AACtC,UAAIC,IAAM,GACNI,IAAmB;AACvB,MAAAT,EAAK,YAAY,QAAQ,CAACM,MAAqB;AAC7C,QAAAG,KAAoBH,EAAQ,QAAA,GAC5BD,KAAOC,EAAQ,QAAA,IAAYA,EAAQ,mBAAmBF,CAAS;AAAA,MACjE,CAAC;AACD,UAAIM,IAAUL,IAAMI,GAChBF,IAAa,IAAEC,EAAcJ,CAAS,IAAEF;AAC5C,MAAAC,EAAS,KAAMF,IAAgBC,KAAM,CAACO,IAAiB,KAAK,IAAI,IAAEC,CAAO,IAAEH,EAAW;AAAA,IACxF,CAAC,GACMJ;AAAA,EACT;AAAA,EAGA,aAAaH,GAAYW,IAAwBC,GAAc;AAO7D,UAAMV,IAAIF,EAAK,aAAA,GACTC,IAAgB,KAAK,eAErBY,IAAK,IAAIC,EAAA,EAAU,UAAU;AAAA,MACjC,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,IAAA,EACX,MAAM,GAGFC,IAAK,IAAID,EAAA,EAAU,UAAU;AAAA,MACjC,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,IAAA,EACX,MAAM,GAGFE,IAAK,IAAIF,EAAA,EAAU,UAAU;AAAA,MACjC,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,MACX,CAAC,GAAG,GAAG,GAAG,CAAC;AAAA,IAAA,EACX,MAAM,GAGFG,IAAS,CAACJ,GAAIE,GAAIC,CAAE,GAGpBE,IADWlB,EAAK,YACa,IAAI,CAAAM,MAAW;AAChD,YAAMa,IAAOb,EAAQ,UAAU,OAAO,CAACc,GAAIC,MAAQ;AAGjD,cAAMC,IAFmBL,EAAO,IAAI,CAAAM,MAAGF,EAAI,IAAI,CAAAG,MAAM,IAAIC,EAAA,EAAU,UAAUD,CAAE,EAAE,aAAaD,CAAC,CAAC,CAAC,EAElE,IAAI,CAAAG,MAAS,IAAIC,EAAS,GAAGD,CAAO,EAAE,SAAS;AAC9E,eAAON,EAAI,IAAI,CAACQ,GAAE7B,MAAI6B,IAAEN,EAAMvB,CAAC,CAAC;AAAA,MAClC,GAAG,CAAC,GAAE,GAAE,CAAC,CAAC,GAEJ8B,IAAUlB,EAAY,IAAI,CAAAmB,MAAMX,EAAK,IAAI,CAAAS,MAAGtB,EAAQ,mBAAmBwB,CAAI,IAAEF,CAAC,CAAC;AACrF,aAAO,EAAE,MAAAT,GAAM,SAAAU,EAAA;AAAA,IACjB,CAAC,GAEK,CAAC,CAACE,GAAIC,CAAE,GAAE,CAACC,GAAIC,CAAE,GAAE,CAACC,GAAIC,CAAE,CAAC,IAAI,CAAC,GAAE,GAAE,CAAC,EAAE,IAAI,CAAArC,MAAG;AAClD,YAAMsC,IAAcnB,EAAkB,OAAO,CAACE,GAAK,EAAE,MAAAD,EAAA,MAASC,IAAMD,EAAKpB,CAAC,GAAG,CAAC,GAExEuC,IADU3B,EAAY,IAAI,CAACmB,GAAKS,MAAMrB,EAAkB,OAAO,CAACE,GAAK,EAAE,SAAAS,EAAAA,MAAaT,IAAIS,EAAQU,CAAC,EAAExC,CAAC,GAAG,CAAC,CAAC,EACxF,IAAI,CAAAyC,MAAQA,IAAOH,CAAW;AACrD,aAAO,CAACA,GAAaC,CAAM;AAAA,IAC7B,CAAC,GAEKG,IAAIV,IAAGE,IAAGE;AAEhB,WAAOxB,EAAY,IAAI,CAACmB,GAAKS,OAEzBtC,IAAcC,KAAM,CAACuC,IAAK,KAAK,IAAI,IAAET,EAAGO,CAAC,CAAC,QAAUR,IAAGU,MACvDxC,IAAcC,KAAM,CAACuC,IAAK,KAAK,IAAI,IAAEP,EAAGK,CAAC,CAAC,QAAUN,IAAGQ,MACvDxC,IAAcC,KAAM,CAACuC,IAAK,KAAK,IAAI,IAAEL,EAAGG,CAAC,CAAC,QAAUJ,IAAGM,EAE1D;AAAA,EACH;AAAA,EAEA,yBAAyB;AAAA,EAAC;AAAA,EAC1B,wBAAwB;AAAA,EAAC;AAAA,EAEzB,oBAAmB;AAEjB,QAAIC,IAAY,GAMZC,IAAM;AAAA,MALM,oBAKK,OAAQ,KAAK,YAAa,UAAU;AAAA,MAJvC,aAKJ,OAAQ,KAAK,UAAW,IAAI,CAACC,MAAIA,EAAE,QAAQF,CAAS,CAAC,EAAE,UAAU;AAAA,MAJ7D,aAKJ,OAAQ,KAAK,UAAW,IAAI,CAACE,MAAIA,EAAE,QAAQF,CAAS,CAAC,EAAE,UAAU;AAAA,MAJjE,oBAKJ,OAAQ,KAAK,MAAO,IAAI,CAACE,MAAIA,EAAE,QAAQF,CAAS,CAAC,EAAE,UAAU;AAAA,IAAA,EACrE,KAAK;AAAA,CAAI;AAEX,YAAQ,IAAIC,CAAG;AAEf,QAAIE,IAAU,IAAI,KAAK,CAACF,CAAG,GAAG,EAAC,MAAM,YAAW;AAChDG,IAAAA,EAAU,OAAOD,GAAS,QAAQ,KAAK,IAAI,MAAM;AAAA,EACnD;AAAA;AAAA,EAIA,IAAI,gBAAe;AACjB,WAAOE,EAAaC,EAAY,SAAA,EAAW,KAAK;AAAA,EAClD;AAAA,EACA,IAAI,OAAM;AACR,WAAO3D,EAAa,SAAA,EAAW,WAAW,KAAK,MAAM;AAAA,EACvD;AAAA,EACA,IAAI,YAAW;AACb,WAAI,KAAK,UAAU,WAAW,KAAK,KAAK,UAAU,WAAW,KAAM,KAAK,MAAM,WAAW;AAAA,EAK3F;AAAA,EACA,IAAI,gBAAe;AACjB,WAAO4D,EAAQ,KAAK,QAAQ,CAAC;AAAA,EAC/B;AAAA,EAEA,IAAI,cAAcC,GAAe;AAC/B,SAAK,SAASA;AAAA,EAChB;AACF;AAEA,SAAS1C,EAAc+B,GAAmB;AAIxC,UAAOA,GAAA;AAAA,IACL,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT,KAAK;AACH,aAAO;AAAA,IACT;AACE,aAAO;AAAA,EAAA;AAEb;AAsBAY,EAAG,YAAYC,EAAUpE,CAAI,CAAC;AAC9BmE,EAAG,eAAe,CAAChE,MAAiB,KAAMkE,EAAU,SAAA,EAAW,QAAQlE,CAAI,EAAW,WAAW;AACjGgE,EAAG,eAAeG,CAAY;AAC9BH,EAAG,yBAAyB,CAAChE,MAAiB,KAAMkE,EAAU,SAAA,EAAW,QAAQlE,CAAI,EAAW,mBAAmB;AACnHgE,EAAG,qBAAqBI,CAAiB;"}