{"version":3,"file":"index-Dj88VSJ6.mjs","sources":["../src/compute/rt/index.ts"],"sourcesContent":["import Solver, { SolverParams } from \"../solver\";\nimport Room from \"../../objects/room\";\nimport Surface from \"../../objects/surface\";\nimport { third_octave, whole_octave, airAttenuation } from '../acoustics';\nimport { RT_CONSTANTS } from '../../constants/rt-constants';\nimport { emit, on } from \"../../messenger\";\nimport { Matrix4, Triangle, Vector3 } from \"three\";\nimport { addSolver, removeSolver, Result, ResultKind, ResultTypes, setSolverProperty, useAppStore, useContainer, useResult, useSolver } from \"../../store\";\nimport { v4 as uuid } from 'uuid';\nimport FileSaver from 'file-saver'; \nimport roundTo from \"../../common/round-to\";\n\nexport interface RT60Props extends SolverParams{\n  //uuid?: string;\n  // containers: KVP<Container>; \n}\n\nexport type RT60SaveObject = {\n  uuid: string;\n  name: string;\n  kind: \"rt60\";\n  autoCalculate: boolean;\n  temperature?: number;\n}\n\nconst defaults = {\n  name: \"RT\",\n};\n\nexport class RT60 extends Solver{\n  public uuid; \n  public sabine_rt: number[]; \n  public eyring_rt: number[];\n  public ap_rt: number[]; \n\n  public volume: number; \n\n  public frequencies: number[];\n\n  public roomID: string;\n\n  public temperature: number;\n\n  public resultID: string;\n\n  public resultExists: boolean; \n\n  constructor(props: RT60Props = defaults) {\n    super(props);\n    this.kind = \"rt60\";\n    this.name = props.name || defaults.name;\n    this.uuid = uuid(); \n\n    this.sabine_rt = [];\n    this.eyring_rt = []; \n    this.ap_rt = [];\n \n    const rooms = useContainer.getState().getRooms();\n    this.roomID = rooms.length > 0 ? rooms[0].uuid : ''; \n\n    this.frequencies = whole_octave.slice(4,11);\n    this.temperature = 20;\n\n    this.resultID = uuid(); \n    this.resultExists = false; \n\n    this.volume = (useContainer.getState().containers[this.roomID] as Room).volumeOfMesh();\n  }\n\n  save() {\n     const { name, kind, uuid, autoCalculate, temperature } = this;\n     return {\n       name,\n       kind,\n       uuid,\n       autoCalculate,\n       temperature,\n     } as RT60SaveObject;\n  }\n\n  restore(state: RT60SaveObject) {\n    // Let the base Solver restore shared properties like autoCalculate\n    super.restore(state);\n    // Restore RT60-specific/core identity properties\n    this.kind = state.kind;\n    this.temperature = state.temperature ?? 20;\n    return this;\n  }\n\n  calculate(){\n\n    this.reset(); \n\n    const airAtten = airAttenuation(this.frequencies, this.temperature);\n    const mValues = airAtten.map(a => a / (20 / Math.log(10))); // convert dB/m to Np/m\n    this.sabine_rt = this.sabine(mValues);\n    this.eyring_rt = this.eyring(mValues);\n    this.ap_rt = this.arauPuchades(this.room,this.frequencies); \n\n    if(!this.resultExists){\n      emit(\"ADD_RESULT\", {\n        kind: ResultKind.StatisticalRT60,\n        data: [],\n        info: {\n          frequency: this.frequencies,\n          airabsorption: false,\n          temperature: this.temperature,\n          humidity: 40,\n        },\n        name: `Statistical RT Results`,\n        uuid: this.resultID,\n        from: this.uuid\n      } as Result<ResultKind.StatisticalRT60>);\n      this.resultExists = true;\n    }\n\n    const rt60results = { ...useResult.getState().results[this.resultID] as Result<ResultKind.StatisticalRT60> };\n    rt60results.data = [] as ResultTypes[ResultKind.StatisticalRT60][\"data\"];\n\n    for(let i = 0; i<this.frequencies.length; i++){\n      rt60results.data.push({\n        frequency: this.frequencies[i], \n        sabine: this.sabine_rt[i],\n        eyring: this.eyring_rt[i],\n        ap: this.ap_rt[i]\n      })\n    }\n    emit(\"UPDATE_RESULT\", { uuid: this.resultID, result: rt60results });\n  }\n\n  reset(){\n    this.sabine_rt = [];\n    this.eyring_rt = []; \n    this.ap_rt = []; \n  }\n\n  sabine(mValues: number[]) {\n    let room = this.room;\n    const unitsConstant = this.unitsConstant;\n    const v = this.volume;\n\n    const response = [] as number[];\n    this.frequencies.forEach((frequency, i) => {\n      let sum = 0;\n      room.allSurfaces.forEach((surface: Surface) => {\n        sum += surface.getArea() * surface.absorptionFunction(frequency);\n      });\n      let airabsterm = 4*mValues[i]*v;\n      response.push((unitsConstant*v)/(sum+airabsterm));\n    });\n    return response;\n  }\n  \n  eyring(mValues: number[]){\n    let room = this.room;\n    const unitsConstant = this.unitsConstant;\n    const v = this.volume;\n\n    const response = [] as number[];\n    this.frequencies.forEach((frequency, i) => {\n      let sum = 0;\n      let totalSurfaceArea = 0;\n      room.allSurfaces.forEach((surface: Surface) => {\n        totalSurfaceArea += surface.getArea();\n        sum += surface.getArea() * surface.absorptionFunction(frequency);\n      });\n      // Clamp α to prevent Math.log(0) = -Infinity or Math.log(negative) = NaN when α ≥ 1\n      let avg_abs = Math.max(0, Math.min(sum / totalSurfaceArea, 0.9999));\n      let airabsterm = 4*mValues[i]*v;\n      response.push((unitsConstant * v) / (-totalSurfaceArea*Math.log(1-avg_abs)+airabsterm));\n    });\n    return response;\n  }\n\n\n  arauPuchades(room: Room, frequencies: number[] = third_octave) {\n    \n    // the goal of arau puchades is to break the surfaces into components (x, y, z)\n    // well do this by projecting each surface onto the planes x=0, y=0, and z=0\n    // https://en.wikipedia.org/wiki/Orthographic_projection\n    \n\n    const v = room.volumeOfMesh();\n    const unitsConstant = this.unitsConstant;\n    // prettier-ignore\n    const Px = new Matrix4().fromArray([\n      [0, 0, 0, 0],\n      [0, 1, 0, 0],\n      [0, 0, 1, 0],\n      [0, 0, 0, 1]\n    ].flat());\n\n    // prettier-ignore\n    const Py = new Matrix4().fromArray([\n      [1, 0, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 1, 0],\n      [0, 0, 0, 1]\n    ].flat());\n\n    // prettier-ignore\n    const Pz = new Matrix4().fromArray([\n      [1, 0, 0, 0],\n      [0, 1, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 0, 1]\n    ].flat());\n\n    // [Px, Py, Pz].map\n    const planes = [Px, Py, Pz];\n\n    const surfaces = room.allSurfaces as Surface[];\n    const projectedSurfaces = surfaces.map(surface => {\n      const area = surface.triangles.reduce((acc,tri) => {\n        const projectedVectors = planes.map(P=>tri.map(pt => new Vector3().fromArray(pt).applyMatrix4(P)));\n        // the projected areas [x,y,z] for this triangle\n        const areas = projectedVectors.map(vectors=>new Triangle(...vectors).getArea());\n        return acc.map((a,i)=>a+areas[i]);\n      }, [0,0,0]);\n\n      const sabines = frequencies.map(freq=>area.map(a=>surface.absorptionFunction(freq)*a));\n      return { area, sabines };\n    });\n\n    const [[Ax, αx],[Ay, αy],[Az, αz]] = [0,1,2].map(i=>{\n      const surfacearea = projectedSurfaces.reduce((acc, { area })=>acc + area[i], 0);\n      const sabines = frequencies.map((freq,f) => projectedSurfaces.reduce((acc, { sabines })=> acc+sabines[f][i], 0));\n      // Clamp α to prevent Math.log(1 - α) from hitting -Infinity or NaN when α ≥ 1\n      const alphas = sabines.map(sabine=>Math.max(0, Math.min(sabine/surfacearea, 0.9999)));\n      return [surfacearea, alphas];\n    });\n\n    const A = Ax+Ay+Az;\n\n    return frequencies.map((freq,f)=>{\n      const airabsterm = 4*airAttenuation([freq])[0]*v;\n      const rt =\n      ((unitsConstant*v) / (-A * (Math.log(1-αx[f])) + airabsterm) ) ** (Ax/A) *\n      ((unitsConstant*v) / (-A * (Math.log(1-αy[f])) + airabsterm) ) ** (Ay/A) *\n      ((unitsConstant*v) / (-A * (Math.log(1-αz[f])) + airabsterm) ) ** (Az/A);\n      return rt;\n    });\n  }\n\n  onParameterConfigFocus() {}\n  onParameterConfigBlur() {}\n\n  downloadRT60AsCSV(){\n\n    let precision = 4;\n    let freqlabel = \"Octave Band (Hz),\"\n    let sabinelabel = \"Sabine RT,\";\n    let eyringlabel = \"Eyring RT,\";\n    let aplabel = \"Arau-Puchades RT,\";\n\n    let CSV = [freqlabel.concat((this.frequencies).toString()),\n      sabinelabel.concat((this.sabine_rt).map((n)=>n.toFixed(precision)).toString()),\n      eyringlabel.concat((this.eyring_rt).map((n)=>n.toFixed(precision)).toString()),\n      aplabel.concat((this.ap_rt).map((n)=>n.toFixed(precision)).toString()),\n    ].join('\\n');\n\n    console.log(CSV); \n\n    var csvFile = new Blob([CSV], {type: 'text/csv'});\n    FileSaver.saveAs(csvFile, `rt60-${this.uuid}.csv`);\n  }\n\n\n  // setters and getters\n  get unitsConstant(){\n    return RT_CONSTANTS[useAppStore.getState().units];\n  }\n  get room(){\n    return useContainer.getState().containers[this.roomID] as Room; \n  }\n  get noResults(){\n    if (this.sabine_rt.length === 0 && this.eyring_rt.length === 0  && this.ap_rt.length === 0 ){\n      return true;\n    }else{\n      return false;\n    }\n  }\n  get displayVolume(){\n    return roundTo(this.volume, 2);\n  }\n\n  set displayVolume(volume: number){\n    this.volume = volume;\n  }\n}\n\n\nexport default RT60;\n\n\n\n// this allows for nice type checking with 'on' and 'emit' from messenger\ndeclare global {\n  interface EventTypes {\n    ADD_RT60: RT60 | undefined,\n    REMOVE_RT60: string,\n    RT60_SET_PROPERTY: {\n      uuid: string;\n      property: keyof RT60;\n      value: RT60[EventTypes[\"RT60_SET_PROPERTY\"][\"property\"]]; \n    }\n    UPDATE_RT60: string; \n    DOWNLOAD_RT60_RESULTS: string; \n  }\n}\n\n// add event listener \non(\"ADD_RT60\", addSolver(RT60)); \non(\"UPDATE_RT60\", (uuid: string) => void (useSolver.getState().solvers[uuid] as RT60).calculate());\non(\"REMOVE_RT60\", removeSolver); \non(\"DOWNLOAD_RT60_RESULTS\", (uuid: string) => void (useSolver.getState().solvers[uuid] as RT60).downloadRT60AsCSV()); \non(\"RT60_SET_PROPERTY\", setSolverProperty); \n\n"],"names":["defaults","RT60","Solver","props","uuid","rooms","useContainer","whole_octave","name","kind","autoCalculate","temperature","state","mValues","airAttenuation","a","emit","ResultKind","rt60results","useResult","i","room","unitsConstant","v","response","frequency","sum","surface","airabsterm","totalSurfaceArea","avg_abs","frequencies","third_octave","Px","Matrix4","Py","Pz","planes","projectedSurfaces","area","acc","tri","areas","P","pt","Vector3","vectors","Triangle","sabines","freq","Ax","αx","Ay","αy","Az","αz","surfacearea","alphas","f","sabine","A","precision","CSV","n","csvFile","FileSaver","RT_CONSTANTS","useAppStore","roundTo","volume","on","addSolver","useSolver","removeSolver","setSolverProperty"],"mappings":"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"}