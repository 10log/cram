{"version":3,"file":"SolverComponents-DyZscYH1.mjs","sources":["../src/components/parameter-config/SolverComponents.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { emit } from \"../../messenger\";\r\nimport { useSolver } from \"../../store\";\r\nimport PropertyRow from \"./property-row/PropertyRow\";\r\nimport PropertyRowLabel from \"./property-row/PropertyRowLabel\";\r\nimport PropertyRowButton from \"./property-row/PropertyRowButton\";\r\nimport { PropertyRowCheckbox } from \"./property-row/PropertyRowCheckbox\";\r\nimport { PropertyRowTextInput } from \"./property-row/PropertyRowTextInput\";\r\nimport { PropertyRowNumberInput } from \"./property-row/PropertyRowNumberInput\";\r\nimport RayTracer from \"../../compute/raytracer\";\r\nimport FDTD_2D from \"../../compute/2d-fdtd\"\r\nimport {AllowedNames } from '../../common/helpers';\r\nimport { ImageSourceSolver } from \"../../compute/raytracer/image-source\";\r\nimport RT60 from \"../../compute/rt\";\r\nimport ART from \"../../compute/radiance/art\";\r\nimport EnergyDecay from \"../../compute/energy-decay\";\r\nimport { BeamTraceSolver } from \"../../compute/beam-trace\";\r\n\r\ntype SetPropertyEventTypes =\r\n  | AllowedNames<EventTypes, SetPropertyPayload<FDTD_2D>>\r\n  | AllowedNames<EventTypes, SetPropertyPayload<RayTracer>>\r\n  | AllowedNames<EventTypes, SetPropertyPayload<ImageSourceSolver>>\r\n  | AllowedNames<EventTypes, SetPropertyPayload<RT60>>\r\n  | AllowedNames<EventTypes, SetPropertyPayload<EnergyDecay>>\r\n  | AllowedNames<EventTypes, SetPropertyPayload<ART>>\r\n  | AllowedNames<EventTypes, SetPropertyPayload<BeamTraceSolver>>\r\n\r\nexport function useSolverProperty<T extends RayTracer | FDTD_2D|ImageSourceSolver|RT60|EnergyDecay|ART|BeamTraceSolver, K extends keyof T>(\r\n  uuid: string,\r\n  property: K,\r\n  event: SetPropertyEventTypes\r\n) {\r\n  // Include version in selector to force re-render when properties change\r\n  const value = useSolver<T[K] | undefined>(\r\n    (state) => {\r\n      // Access state.version to ensure selector subscribes to version changes (triggers re-render)\r\n      const _version = state.version;\r\n      const solver = state.solvers[uuid] as T | undefined;\r\n      return solver?.[property];\r\n    }\r\n  );\r\n  //@ts-ignore\r\n  const changeHandler = (e: any) => emit(event, { uuid, property, value: e.value });\r\n\r\n  return [value, changeHandler] as [typeof value, typeof changeHandler];\r\n}\r\n\r\ntype PropertyRowInputElement = ({ value, onChange }: { value: any, onChange: any }) => JSX.Element;\r\ntype Props<T extends RayTracer | FDTD_2D|ImageSourceSolver|RT60|EnergyDecay|ART|BeamTraceSolver, K extends keyof T> = {\r\n  uuid: string;\r\n  property: K;\r\n  label: string;\r\n  tooltip: string;\r\n  elementProps?: {\r\n    [key: string]: any\r\n  }\r\n};\r\n\r\nexport const createPropertyInput = <T extends RayTracer | FDTD_2D|ImageSourceSolver|RT60|EnergyDecay|ART|BeamTraceSolver>(\r\n  event: SetPropertyEventTypes,\r\n  Element: PropertyRowInputElement\r\n) => <K extends keyof T>({ uuid, property, label, tooltip, elementProps }: Props<T, K>) => {\r\n  const [state, changeHandler] = useSolverProperty<T, K>(uuid, property, event);\r\n  return (\r\n    <PropertyRow>\r\n      <PropertyRowLabel label={label} hasToolTip tooltip={tooltip} />\r\n      <Element value={state} onChange={changeHandler} {...elementProps} />\r\n    </PropertyRow>\r\n  );\r\n};\r\n\r\nexport const createPropertyInputs = <T extends RayTracer|FDTD_2D|ImageSourceSolver|RT60|EnergyDecay|ART|BeamTraceSolver>(event: SetPropertyEventTypes) => ({\r\n  PropertyTextInput: createPropertyInput<T>(event, PropertyRowTextInput),\r\n  PropertyNumberInput: createPropertyInput<T>(event, PropertyRowNumberInput),\r\n  PropertyCheckboxInput: createPropertyInput<T>(event, PropertyRowCheckbox),\r\n})\r\n\r\nexport const PropertyButton = <T extends keyof EventTypes>({\r\n  args,\r\n  event,\r\n  label,\r\n  tooltip,\r\n  disabled,\r\n}: {\r\n  args: EventTypes[T];\r\n  event: T;\r\n  label: string;\r\n  tooltip: string;\r\n  disabled?: boolean;\r\n}) => {\r\n  return (\r\n    <PropertyRow>\r\n      <PropertyRowLabel label={label} hasToolTip tooltip={tooltip} />\r\n      <PropertyRowButton onClick={(_e) => emit(event, args)} label={label} disabled={disabled} />\r\n    </PropertyRow>\r\n  );\r\n};\r\n"],"names":["useSolverProperty","uuid","property","event","useSolver","state","emit","createPropertyInput","Element","label","tooltip","elementProps","changeHandler","PropertyRow","jsx","PropertyRowLabel","createPropertyInputs","PropertyRowTextInput","PropertyRowNumberInput","PropertyRowCheckbox","PropertyButton","args","disabled","PropertyRowButton","_e"],"mappings":";;AA2BO,SAASA,EACdC,GACAC,GACAC,GACA;AAaA,SAAO,CAXOC;AAAA,IACZ,CAACC,OAEkBA,EAAM,SACRA,EAAM,QAAQJ,CAAI,IACjBC,CAAQ;AAAA,EAC1B,GAGoB,CAAC,MAAWI,EAAKH,GAAO,EAAE,MAAAF,GAAM,UAAAC,GAAU,OAAO,EAAE,MAAA,CAAO,CAEpD;AAC9B;AAaO,MAAMK,IAAsB,CACjCJ,GACAK,MACG,CAAoB,EAAE,MAAAP,GAAM,UAAAC,GAAU,OAAAO,GAAO,SAAAC,GAAS,cAAAC,QAAgC;AACzF,QAAM,CAACN,GAAOO,CAAa,IAAIZ,EAAwBC,GAAMC,GAAUC,CAAK;AAC5E,2BACGU,GAAA,EACC,UAAA;AAAA,IAAA,gBAAAC,EAACC,GAAA,EAAiB,OAAAN,GAAc,YAAU,IAAC,SAAAC,GAAkB;AAAA,sBAC5DF,GAAA,EAAQ,OAAOH,GAAO,UAAUO,GAAgB,GAAGD,EAAA,CAAc;AAAA,EAAA,GACpE;AAEJ,GAEaK,IAAuB,CAAqFb,OAAkC;AAAA,EACzJ,mBAAmBI,EAAuBJ,GAAOc,CAAoB;AAAA,EACrE,qBAAqBV,EAAuBJ,GAAOe,CAAsB;AAAA,EACzE,uBAAuBX,EAAuBJ,GAAOgB,CAAmB;AAC1E,IAEaC,IAAiB,CAA6B;AAAA,EACzD,MAAAC;AAAA,EACA,OAAAlB;AAAA,EACA,OAAAM;AAAA,EACA,SAAAC;AAAA,EACA,UAAAY;AACF,wBAQKT,GAAA,EACC,UAAA;AAAA,EAAA,gBAAAC,EAACC,GAAA,EAAiB,OAAAN,GAAc,YAAU,IAAC,SAAAC,GAAkB;AAAA,EAC7D,gBAAAI,EAACS,GAAA,EAAkB,SAAS,CAACC,MAAOlB,EAAKH,GAAOkB,CAAI,GAAG,OAAAZ,GAAc,UAAAa,EAAA,CAAoB;AAAA,GAC3F;"}